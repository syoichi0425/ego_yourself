<!DOCTYPE html>
<html>
<head>
<title><%= current_user.username %>さんのマイページ</title>

</head>
<body>

<h3>自分の名前<%= current_user.username %>がここに入る</h3>

<%=image_tag "PF_logo.png"%>
<ul>プロフィール画像</ul>
<ul><%= link_to 'プロフィール変更', edit_user_registration_path ,class: "link"%></ul>

<ul>
<%=link_to "診断結果","/egograms/result"%></ul>
<ul>
<%=link_to "診断結果index","/egograms/index",class: "link"%>
</ul>
<h2>高めたいタイプ</h2>

<% k=User.where(id: current_user.id).pluck(:raise_type_id)%>
<% l=RaiseType.where(id: k).pluck(:raise_type) %>
<%= l.slice(0) %>


<%
=begin%>

未実装：高めたいタイプで送信ボタンsubmitすると下記エラーが出る
ActiveRecord::RecordNotFound in Contents#create
Showing /Users/syoichi/PF/app/views/contents/index.html.erb where line #43 raised:
Couldn't find TestResult without an ID

  <%= form_with model: @raise_type_id,url: {controller: 'contents', action: 'create' }, local: true,method: :post do |f| %>

 modele: @test,url: {controller: 'contents', action: 'create' }, local: true,method: :post

 <%= f.select :raise_type_id, [["CPタイプ", 1], ["NPタイプ", "2"], ["Aタイプ", "3"], ["FCタイプ", "4"],["ACタイプ", "5"]]%>

     <%= f.submit 'タイプを変更', class: 'btn btn-primary'%>

  <% end %>
<%
=end%>




            <h2 class= "result_egogram_type_title">最新のエゴグラム
              <%=TestResult.find(@result).egogram_type%>タイプ
            </h2>
<div class="graph">
      <%= line_chart ({"cp" => @cp, "np" => @np, "a" => @a, "fc" => @np, "ac" => @ac}),width: "300px", height: "300px",colors: ["#b00", "#666"] ,min: 0, max: 20 %>
</div>
  <div class="result_container">






  </div>


<h1>カレンダー</h1>



<%= month_calendar events: @diaries do |date,diaries| %>

<% a=@diaries.where(created_at: date).pluck(:created_at)%>
<% b=a.map{ |i| i.strftime("%Y-%m-%d")}%>
<%b[0]%>
<%date%>
<% c=@diaries.where(created_at: date).pluck(:id)%>
<!--ここで現在のuser_idの選択したカレンダーの日にちの記事のidを取得している-->
<%c[0]%>

<%if b[0].to_s == date.to_s%>
<%#= link_to date,edit_diary_path(current_user,diary_day: diary_created_at)%>
<%= link_to date.day,edit_diary_path(c,diary_day: date) %>
<p>Check</p>

<%else%>
<%=link_to date.day,new_diary_path(current_user,diary_day: date)%>

<%end%>

<% end %>

<%
=begin%>



<h1>最新のエゴグラム</h1>

      <%= line_chart ({"cp" => @cp, "np" => @np, "a" => @a, "fc" => @np, "ac" => @ac})%>

  <div class="result_container">


      <h2><span>aa</span>CSS見出し</h2>

            <h1 class= "heading07" data-en="Your Result">
              エゴグラム診断結果
            </h1>

            <h1 class= "result_egogram_type_title">
              <%=TestResult.find(@result).egogram_type%>タイプ
            </h1>



  </div>







<%
=end%>

</body>

<%= yield %>
</html>